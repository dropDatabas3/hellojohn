# --- Entorno ---
APP_ENV=dev  # dev|staging|prod

# --- Server ---
SERVER_ADDR=:8080
SERVER_CORS_ALLOWED_ORIGINS=http://localhost:3000

# --- Storage ---
STORAGE_DRIVER=postgres
STORAGE_DSN=postgres://postgres:postgres@localhost:5432/hellojohn?sslmode=disable
POSTGRES_MAX_OPEN_CONNS=30
POSTGRES_MAX_IDLE_CONNS=10
POSTGRES_CONN_MAX_LIFETIME=30m

# --- Cache / Rate ---
CACHE_KIND=memory
#CACHE_KIND=redis
#REDIS_ADDR=localhost:6379
#REDIS_DB=0
#REDIS_PREFIX=hj:
RATE_ENABLED=true
RATE_WINDOW=1m
RATE_MAX_REQUESTS=60
RATE_LOGIN_LIMIT=10
RATE_LOGIN_WINDOW=1m
RATE_FORGOT_LIMIT=5
RATE_FORGOT_WINDOW=10m

# --- JWT ---
JWT_ISSUER=http://localhost:8080
JWT_ACCESS_TTL=15m
JWT_REFRESH_TTL=720h

# --- Register / Auth ---
REGISTER_AUTO_LOGIN=true
AUTH_ALLOW_BEARER_SESSION=true
AUTH_SESSION_COOKIE_NAME=sid
AUTH_SESSION_DOMAIN=
AUTH_SESSION_SAMESITE=Lax
AUTH_SESSION_SECURE=false
AUTH_SESSION_TTL=12h

AUTH_RESET_TTL=1h
AUTH_RESET_AUTO_LOGIN=true
AUTH_VERIFY_TTL=48h

# --- MFA (ENV-ONLY) ---
MFA_TOTP_WINDOW=1
MFA_TOTP_ISSUER=HelloJohn
MFA_REMEMBER_TTL=720h

# Clave maestra (dev): usa un valor de 32 bytes (ejemplo)
SIGNING_MASTER_KEY=0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef

# --- SMTP (rellenar para enviar mails reales) ---
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=tu_usuario@gmail.com
SMTP_PASSWORD=tu_password_ou_app_password
SMTP_FROM=tu_usuario@gmail.com
SMTP_TLS=starttls
SMTP_INSECURE_SKIP_VERIFY=false

# --- Email ---
EMAIL_BASE_URL=http://localhost:8080
EMAIL_TEMPLATES_DIR=./templates
EMAIL_DEBUG_LINKS=true  # Dev: útil para test. En prod se fuerza a false.

# --- Seguridad (password policy) ---
SECURITY_PASSWORD_POLICY_MIN_LENGTH=10
SECURITY_PASSWORD_POLICY_REQUIRE_UPPER=true
SECURITY_PASSWORD_POLICY_REQUIRE_LOWER=true
SECURITY_PASSWORD_POLICY_REQUIRE_DIGIT=true
SECURITY_PASSWORD_POLICY_REQUIRE_SYMBOL=false

# --- Flags ---
FLAGS_MIGRATE=true

# ───────── Providers: Google ─────────
GOOGLE_ENABLED=false
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
GOOGLE_REDIRECT_URL=
GOOGLE_SCOPES=openid,email,profile
GOOGLE_ALLOWED_TENANTS=
GOOGLE_ALLOWED_CLIENTS=

# ───────── Social (TTL del código devuelto por /social/result) ─────────
SOCIAL_LOGIN_CODE_TTL=60s

# ───────── Opcional: SEED (cmd/seed) ─────────
# SEED_TENANT_SLUG=local
# SEED_TENANT_NAME=Local Tenant
# SEED_ADMIN_EMAIL=admin@local.test
# SEED_ADMIN_PASSWORD=SuperS3creta!
# SEED_MFA_EMAIL=mfa@local.test
# SEED_MFA_PASSWORD=CorrectHorseBatteryStaple1!
# SEED_UNVERIFIED_EMAIL=new@local.test
# SEED_UNVERIFIED_PASSWORD=Password.1234
# SEED_CLIENT_ID=web-frontend
# SEED_CLIENT_NAME=Web Frontend
# SEED_CLIENT_TYPE=public
# SEED_BACKEND_CLIENT_ID=backend-api
# SEED_BACKEND_CLIENT_NAME=Backend API
# SEED_BACKEND_CLIENT_TYPE=confidential
# SEED_ALLOWED_ORIGINS=http://localhost:3000,http://127.0.0.1:3000
# SEED_REDIRECT_URIS=http://localhost:3000/callback,http://localhost:8080/v1/auth/social/result
# SEED_PROVIDERS=password,google
# SEED_SCOPES=openid,email,profile,offline_access
