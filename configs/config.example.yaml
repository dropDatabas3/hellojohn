server:
  addr: ":8080"
  cors_allowed_origins:
    - "http://localhost:3000"
    - "http://127.0.0.1:3000"

storage:
  driver: "postgres"
  dsn: "postgres://user:password@localhost:5432/login?sslmode=disable"
  postgres:
    max_open_conns: 30
    max_idle_conns: 5
    conn_max_lifetime: "30m"
  mysql:
    dsn: "user:pass@tcp(localhost:3306)/login?parseTime=true&charset=utf8mb4"
  mongo:
    uri: "mongodb://user:pass@localhost:27017"
    database: "login"

cache:
  kind: "redis"
  redis:
    addr: "localhost:6379"
    db: 0
    prefix: "login:"
  memory:
    default_ttl: "2m"

jwt:
  issuer: "http://localhost:8080"
  access_ttl: "15m"
  refresh_ttl: "720h"   # 30d

auth:
  allow_bearer_session: true
  session:
    cookie_name: "sid"
    domain: ""
    samesite: "Lax"
    secure: false
    ttl: "12h"
  reset:
    ttl: "60m"
    auto_login: true
  verify:
    ttl: "48h"

register:
  auto_login: true

rate:
  enabled: true
  window: "1m"
  max_requests: 60

flags:
  migrate: true

# ───────── Gmail SMTP ─────────
smtp:
  host: "smtp.gmail.com"
  port: 587                 # Gmail en 587 usa STARTTLS
  username: "juanpalacio1996@gmail.com"
  password: "gezl zchi oken ubkl"   # tu App Password de Google tal cual (con espacios)
  from: "juanpalacio1996@gmail.com" # en Gmail conviene que FROM == username
  tls: "starttls"           # starttls | ssl(465) | auto | none
  insecure_skip_verify: false

email:
  base_url: "http://localhost:8080"
  templates_dir: "./templates"
  debug_echo_links: true    # deja los X-Debug-* para facilitar el test

# ───────── Social Login ─────────
providers:
  google:
    enabled: false
    client_id: ""           # requerido si enabled=true
    client_secret: ""       # requerido si enabled=true
    # Si se deja vacío, se autocompleta con: <jwt.issuer>/v1/auth/social/google/callback
    redirect_url: ""
    # Defaults sensatos; podés dejarlos así
    scopes: ["openid","email","profile"]
    # Vacíos => permitido para todos (universal)
    allowed_tenants: []
    allowed_clients: []

security:
  password_policy:
    min_length: 10
    require_upper: true
    require_lower: true
    require_digit: true
    require_symbol: false
