#Para verificar que en “prod” no se exponen X-Debug-* y revisar CORS/cookies.
APP_ENV=prod

SERVER_ADDR=:8080
SERVER_CORS_ALLOWED_ORIGINS=http://localhost:3000

STORAGE_DRIVER=postgres
STORAGE_DSN=postgres://user:password@localhost:5432/login?sslmode=disable
POSTGRES_MAX_OPEN_CONNS=30
POSTGRES_MAX_IDLE_CONNS=5
POSTGRES_CONN_MAX_LIFETIME=30m

CACHE_KIND=redis
REDIS_ADDR=localhost:6379
REDIS_DB=0
REDIS_PREFIX=login:
RATE_ENABLED=true
RATE_WINDOW=1m
RATE_MAX_REQUESTS=60

JWT_ISSUER=http://localhost:8080
JWT_ACCESS_TTL=15m
JWT_REFRESH_TTL=720h

REGISTER_AUTO_LOGIN=true
AUTH_ALLOW_BEARER_SESSION=true
AUTH_SESSION_COOKIE_NAME=sid
AUTH_SESSION_DOMAIN=
AUTH_SESSION_SAMESITE=Lax
AUTH_SESSION_SECURE=false   # ponelo en true si probás bajo HTTPS
AUTH_SESSION_TTL=12h

AUTH_VERIFY_TTL=48h
AUTH_RESET_TTL=1h
AUTH_RESET_AUTO_LOGIN=true

# SMTP: elegí Gmail o MailHog igual que en .env.dev
SMTP_HOST=127.0.0.1
SMTP_PORT=1025
SMTP_USERNAME=
SMTP_PASSWORD=
SMTP_FROM=dev@example.local
SMTP_TLS=none
SMTP_INSECURE_SKIP_VERIFY=false

EMAIL_BASE_URL=http://localhost:8080
EMAIL_TEMPLATES_DIR=./templates
EMAIL_DEBUG_LINKS=false  # <- clave en prod-like

SECURITY_PASSWORD_POLICY_MIN_LENGTH=10
SECURITY_PASSWORD_POLICY_REQUIRE_UPPER=true
SECURITY_PASSWORD_POLICY_REQUIRE_LOWER=true
SECURITY_PASSWORD_POLICY_REQUIRE_DIGIT=true
SECURITY_PASSWORD_POLICY_REQUIRE_SYMBOL=false

FLAGS_MIGRATE=true
